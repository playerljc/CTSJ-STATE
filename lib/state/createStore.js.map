{"version":3,"sources":["state/createStore.js"],"names":["__importDefault","this","mod","__esModule","default","Object","defineProperty","exports","value","immutable_1","require","trigger","action","listeners","forEach","ins","Store","reducer","preloadedState","state","assign","prototype","getState","cloneDeep","dispatch","Function","bind","call","subscribe","listener","_this","push","index","indexOf","splice","default_1"],"mappings":"AAAA,aACA,IAAIA,gBAAmBC,MAAQA,KAAKD,iBAAoB,SAAUE,GAC9D,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAEE,QAAWF,IAExDG,OAAOC,eAAeC,QAAS,aAAc,CAAEC,OAAO,IACtD,IAAIC,YAAcT,gBAAgBU,QAAQ,sBAK1C,SAASC,QAAQC,GACGX,KAAKY,UACXC,QAAQ,SAAUC,GACxBA,EAAIH,KAQZ,IAAII,MAAuB,WAMvB,SAASA,EAAMC,EAASC,QACG,IAAnBA,IAA6BA,EAAiB,IAClDjB,KAAKgB,QAAUA,EACfhB,KAAKkB,MAAQd,OAAOe,OAAO,GAAIF,GAC/BjB,KAAKY,UAAY,GAsCrB,OAhCAG,EAAMK,UAAUC,SAAW,WACvB,OAAOb,YAAYL,QAAQmB,UAAUtB,KAAKkB,QAM9CH,EAAMK,UAAUG,SAAW,SAAUZ,GACjC,GAAIA,aAAkBa,SAClBb,EAAOX,KAAKuB,SAASE,KAAKzB,WAEzB,CACD,IAAIkB,EAAQlB,KAAKgB,QAAQR,YAAYL,QAAQmB,UAAUtB,KAAKkB,OAAQP,GACpEX,KAAKkB,MAAQV,YAAYL,QAAQmB,UAAUJ,GAC3CR,QAAQgB,KAAK1B,KAAMW,KAQ3BI,EAAMK,UAAUO,UAAY,SAAUC,GAClC,IAAIC,EAAQ7B,KAEZ,OADAA,KAAKY,UAAUkB,KAAKF,GACb,WACH,IAAIG,EAAQF,EAAMjB,UAAUoB,QAAQJ,IACrB,IAAXG,GACAF,EAAMjB,UAAUqB,OAAOF,EAAO,KAInChB,EAhDe,GAwD1B,SAASmB,UAAUlB,EAASC,GACxB,OAAO,IAAIF,MAAMC,EAASC,GAE9BX,QAAQH,QAAU+B","file":"createStore.js","sourcesContent":["\"use strict\";\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar immutable_1 = __importDefault(require(\"../util/immutable\"));\r\n/**\r\n * trigger\r\n * @access private\r\n */\r\nfunction trigger(action) {\r\n    var listeners = this.listeners;\r\n    listeners.forEach(function (ins) {\r\n        ins(action);\r\n    });\r\n}\r\n/**\r\n * Store\r\n * @class Store\r\n * @classdesc Store\r\n */\r\nvar Store = /** @class */ (function () {\r\n    /**\r\n     * constrcutor\r\n     * @param {Function} - reducer\r\n     * @param {Object | Array} - preloadedState\r\n     */\r\n    function Store(reducer, preloadedState) {\r\n        if (preloadedState === void 0) { preloadedState = {}; }\r\n        this.reducer = reducer;\r\n        this.state = Object.assign({}, preloadedState);\r\n        this.listeners = [];\r\n    }\r\n    /**\r\n     * getState\r\n     * @return {Object}\r\n     */\r\n    Store.prototype.getState = function () {\r\n        return immutable_1.default.cloneDeep(this.state);\r\n    };\r\n    /**\r\n     * dispatch\r\n     * @param {Object | Function} - action\r\n     */\r\n    Store.prototype.dispatch = function (action) {\r\n        if (action instanceof Function) {\r\n            action(this.dispatch.bind(this));\r\n        }\r\n        else {\r\n            var state = this.reducer(immutable_1.default.cloneDeep(this.state), action);\r\n            this.state = immutable_1.default.cloneDeep(state);\r\n            trigger.call(this, action);\r\n        }\r\n    };\r\n    /**\r\n     * subscribe\r\n     * @param {Function} - listener\r\n     * @return {Function}\r\n     */\r\n    Store.prototype.subscribe = function (listener) {\r\n        var _this = this;\r\n        this.listeners.push(listener);\r\n        return function () {\r\n            var index = _this.listeners.indexOf(listener);\r\n            if (index !== -1) {\r\n                _this.listeners.splice(index, 1);\r\n            }\r\n        };\r\n    };\r\n    return Store;\r\n}());\r\n/**\r\n * createStore\r\n * @param {Function} - reducer\r\n * @param {Object | Array} preloadedState\r\n * @return {Store}\r\n */\r\nfunction default_1(reducer, preloadedState) {\r\n    return new Store(reducer, preloadedState);\r\n}\r\nexports.default = default_1;\r\n"]}