{"version":3,"sources":["state/createStore.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_default","_classCallCheck2","_createClass2","trigger","action","this","listeners","forEach","ins","Store","reducer","preloadedState","arguments","length","undefined","middlewares","state","assign","key","Function","dispatch","bind","i","before","_i","after","call","listener","_this","push","index","indexOf","splice"],"mappings":"AAAA,aAEA,IAAIA,uBAAyBC,QAAQ,gDAErCC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAETD,QAAiB,QAAIE,SAErB,IAAIC,iBAAmBP,uBAAuBC,QAAQ,0CAElDO,cAAgBR,uBAAuBC,QAAQ,uCAMnD,SAASQ,QAAQC,GACCC,KAAKC,UACXC,QAAQ,SAAUC,GAC1BA,EAAIJ,KAUR,IAAIK,MAAqB,WAOvB,SAASA,EAAMC,GACb,IAAIC,EAAoC,EAAnBC,UAAUC,aAA+BC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,GACrFG,EAAiC,EAAnBH,UAAUC,aAA+BC,IAAjBF,UAAU,GAAmBA,UAAU,GAAK,IACtF,EAAIX,iBAA0B,SAAGI,KAAMI,GACvCJ,KAAKK,QAAUA,EACfL,KAAKW,MAAQpB,OAAOqB,OAAO,GAAIN,GAC/BN,KAAKU,YAAcA,GAAe,GAClCV,KAAKC,UAAY,GAiEnB,OAzDA,EAAIJ,cAAuB,SAAGO,EAAO,CAAC,CACpCS,IAAK,WACLnB,MAAO,WACL,OAAOM,KAAKW,QAOb,CACDE,IAAK,WACLnB,MAAO,SAAkBK,GACvB,GAAIA,aAAkBe,SACpBf,EAAOC,KAAKe,SAASC,KAAKhB,WACrB,CACL,GAAIA,KAAKU,YACP,IAAK,IAAIO,EAAIjB,KAAKU,YAAYF,OAAS,EAAQ,GAALS,EAAQA,IAAK,EAErDC,EADalB,KAAKU,YAAYO,GAAGC,QAC1BlB,KAAKW,MAAOZ,GAIvB,IAAIY,EAAQX,KAAKK,QAAQL,KAAKW,MAAOZ,GAGrC,GAFAC,KAAKW,MAAQA,EAETX,KAAKU,YACP,IAAK,IAAIS,EAAK,EAAGA,EAAKnB,KAAKU,YAAYF,OAAQW,IAAM,EAEnDC,EADYpB,KAAKU,YAAYS,GAAIC,OAC3BpB,KAAKW,MAAOZ,GAItBD,QAAQuB,KAAKrB,KAAMD,MAStB,CACDc,IAAK,YACLnB,MAAO,SAAmB4B,GACxB,IAAIC,EAAQvB,KAGZ,OADAA,KAAKC,UAAUuB,KAAKF,GACb,WACL,IAAIG,EAAQF,EAAMtB,UAAUyB,QAAQJ,IAErB,IAAXG,GACFF,EAAMtB,UAAU0B,OAAOF,EAAO,QAK/BrB,EA/EgB,GAyFzB,SAAST,SAASU,EAASC,GACzB,OAAO,IAAIF,MAAMC,EAASC","file":"createStore.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = _default;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\n/**\r\n * trigger\r\n * @access private\r\n */\nfunction trigger(action) {\n  var listeners = this.listeners;\n  listeners.forEach(function (ins) {\n    ins(action);\n  });\n}\n/**\r\n * Store\r\n * @class Store\r\n * @classdesc Store\r\n */\n\n\nvar Store = /*#__PURE__*/function () {\n  /**\r\n   * constrcutor\r\n   * @param {Function} - reducer\r\n   * @param {Object | Array} - preloadedState\r\n   * @param {Array} - middlewares\r\n   */\n  function Store(reducer) {\n    var preloadedState = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n    var middlewares = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n    (0, _classCallCheck2[\"default\"])(this, Store);\n    this.reducer = reducer;\n    this.state = Object.assign({}, preloadedState);\n    this.middlewares = middlewares || [];\n    this.listeners = [];\n  }\n  /**\r\n   * getState\r\n   * @return {Object}\r\n   */\n\n\n  (0, _createClass2[\"default\"])(Store, [{\n    key: \"getState\",\n    value: function getState() {\n      return this.state;\n    }\n    /**\r\n     * dispatch\r\n     * @param {Object | Function} - action\r\n     */\n\n  }, {\n    key: \"dispatch\",\n    value: function dispatch(action) {\n      if (action instanceof Function) {\n        action(this.dispatch.bind(this));\n      } else {\n        if (this.middlewares) {\n          for (var i = this.middlewares.length - 1; i >= 0; i--) {\n            var before = this.middlewares[i].before;\n            before(this.state, action);\n          }\n        }\n\n        var state = this.reducer(this.state, action);\n        this.state = state;\n\n        if (this.middlewares) {\n          for (var _i = 0; _i < this.middlewares.length; _i++) {\n            var after = this.middlewares[_i].after;\n            after(this.state, action);\n          }\n        }\n\n        trigger.call(this, action);\n      }\n    }\n    /**\r\n     * subscribe\r\n     * @param {Function} - listener\r\n     * @return {Function}\r\n     */\n\n  }, {\n    key: \"subscribe\",\n    value: function subscribe(listener) {\n      var _this = this;\n\n      this.listeners.push(listener);\n      return function () {\n        var index = _this.listeners.indexOf(listener);\n\n        if (index !== -1) {\n          _this.listeners.splice(index, 1);\n        }\n      };\n    }\n  }]);\n  return Store;\n}();\n/**\r\n * createStore\r\n * @param {Function} - reducer\r\n * @param {Object | Array} preloadedState\r\n * @return {Store}\r\n */\n\n\nfunction _default(reducer, preloadedState) {\n  return new Store(reducer, preloadedState);\n}"]}