{"version":3,"sources":["react/createConnect.js"],"names":["__extends","this","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__importDefault","mod","__esModule","default","defineProperty","exports","value","react_1","require","immutable_1","Context_1","mapStateToProps","mapDispatchToProps","Component","_super","class_1","componentDidMount","_this","unsubscribe","store","subscribe","action","state","getState","setState","success","ins","other","cloneDeep","componentWillUnmount","getInstance","render","createElement","ProviderContext","Consumer","_a","dispatch","bind","props","ref"],"mappings":"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","file":"createConnect.js","sourcesContent":["\"use strict\";\r\nvar __extends = (this && this.__extends) || (function () {\r\n    var extendStatics = function (d, b) {\r\n        extendStatics = Object.setPrototypeOf ||\r\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n        return extendStatics(d, b);\r\n    };\r\n    return function (d, b) {\r\n        extendStatics(d, b);\r\n        function __() { this.constructor = d; }\r\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n    };\r\n})();\r\nvar __assign = (this && this.__assign) || function () {\r\n    __assign = Object.assign || function(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\r\n                t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\nvar __rest = (this && this.__rest) || function (s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n};\r\nvar __importDefault = (this && this.__importDefault) || function (mod) {\r\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\r\n};\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar react_1 = __importDefault(require(\"react\"));\r\nvar immutable_1 = __importDefault(require(\"../util/immutable\"));\r\nvar Context_1 = require(\"./Context\");\r\n/**\r\n * createConnect\r\n * @param {Function} - mapStateToProps\r\n * @param {Function} - mapDispatchToProps\r\n * @return {HOC}\r\n */\r\nexports.default = (function (mapStateToProps, mapDispatchToProps) {\r\n    /**\r\n     * ConnectHOC\r\n     * @param {ReactElement} - Component\r\n     */\r\n    return function (Component) {\r\n        return /** @class */ (function (_super) {\r\n            __extends(class_1, _super);\r\n            function class_1(props) {\r\n                var _this = _super.call(this, props) || this;\r\n                _this.state = {\r\n                    state: null,\r\n                };\r\n                return _this;\r\n            }\r\n            class_1.prototype.componentDidMount = function () {\r\n                var _this = this;\r\n                this.unsubscribe = this.store.subscribe(function (action) {\r\n                    var state = _this.store.getState();\r\n                    _this.setState({\r\n                        state: state,\r\n                    }, function () {\r\n                        // 如果是当前实力进行的数据更改才会调用success\r\n                        var success = action.success, ins = action.ins, other = __rest(action, [\"success\", \"ins\"]);\r\n                        // console.log('redux进行了数据改变的通知');\r\n                        // console.log(action);\r\n                        // console.log(this.ins);\r\n                        // console.log(this.ins === ins);\r\n                        if (success && ins) {\r\n                            if (_this.ins === ins) {\r\n                                success.call(ins, immutable_1.default.cloneDeep(other));\r\n                            }\r\n                        }\r\n                    });\r\n                });\r\n            };\r\n            class_1.prototype.componentWillUnmount = function () {\r\n                this.unsubscribe();\r\n            };\r\n            /**\r\n             * getInstance\r\n             * @return {ReactElement}\r\n             */\r\n            class_1.prototype.getInstance = function () {\r\n                return this.ins;\r\n            };\r\n            class_1.prototype.render = function () {\r\n                var _this = this;\r\n                return (react_1.default.createElement(Context_1.ProviderContext.Consumer, null, function (_a) {\r\n                    var store = _a.store;\r\n                    if (!_this.store)\r\n                        _this.store = store;\r\n                    var state = _this.state.state ? _this.state.state : _this.store.getState();\r\n                    var dispatch = {};\r\n                    if (mapDispatchToProps) {\r\n                        dispatch = mapDispatchToProps(_this.store.dispatch.bind(_this.store));\r\n                    }\r\n                    var props = {};\r\n                    if (mapStateToProps) {\r\n                        props = mapStateToProps(state);\r\n                    }\r\n                    return (react_1.default.createElement(Component, __assign({ ref: function (ins) {\r\n                            _this.ins = ins;\r\n                        } }, _this.props, props, dispatch, { dispatch: store.dispatch })));\r\n                }));\r\n            };\r\n            return class_1;\r\n        }(react_1.default.Component));\r\n    };\r\n});\r\n"]}