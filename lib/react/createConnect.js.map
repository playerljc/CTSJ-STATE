{"version":3,"sources":["react/createConnect.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_extends2","_objectWithoutProperties2","_classCallCheck2","_createClass2","_possibleConstructorReturn2","_getPrototypeOf2","_inherits2","_react","_immutable","_Context","_default","mapStateToProps","mapDispatchToProps","Component","_React$Component","_class","props","_this","this","call","state","key","_this2","unsubscribe","store","subscribe","action","getState","setState","success","ins","other","cloneDeep","_this3","createElement","ProviderContext","Consumer","_ref","dispatch","bind","ref"],"mappings":"AAAA,aAEA,IAAIA,uBAAyBC,QAAQ,gDAErCC,OAAOC,eAAeC,QAAS,aAAc,CAC3CC,OAAO,IAETD,QAAiB,aAAI,EAErB,IAAIE,UAAYN,uBAAuBC,QAAQ,mCAE3CM,0BAA4BP,uBAAuBC,QAAQ,mDAE3DO,iBAAmBR,uBAAuBC,QAAQ,0CAElDQ,cAAgBT,uBAAuBC,QAAQ,uCAE/CS,4BAA8BV,uBAAuBC,QAAQ,qDAE7DU,iBAAmBX,uBAAuBC,QAAQ,0CAElDW,WAAaZ,uBAAuBC,QAAQ,oCAE5CY,OAASb,uBAAuBC,QAAQ,UAExCa,WAAad,uBAAuBC,QAAQ,sBAE5Cc,SAAWd,QAAQ,aAQnBe,SAAW,SAAkBC,EAAiBC,GAKhD,OAAO,SAAUC,GACf,OAAqB,SAAUC,GAG3B,SAASC,EAAOC,GACd,IAAIC,EAOJ,OALA,EAAIf,iBAA0B,SAAGgB,KAAMH,IACvCE,GAAQ,EAAIb,4BAAqC,SAAGc,MAAM,EAAIb,iBAA0B,SAAGU,GAAQI,KAAKD,KAAMF,KACxGI,MAAQ,CACZA,MAAO,MAEFH,EA0ET,OApFA,EAAIX,WAAoB,SAAGS,EAAQD,IAanC,EAAIX,cAAuB,SAAGY,EAAQ,CAAC,CACrCM,IAAK,oBACLtB,MAAO,WACL,IAAIuB,EAASJ,KAEbA,KAAKK,YAAcL,KAAKM,MAAMC,UAAU,SAAUC,GAChD,IAAIN,EAAQE,EAAOE,MAAMG,WAEzBL,EAAOM,SAAS,CACdR,MAAOA,GACN,WAED,IAAIS,EAAUH,EAAOG,QACjBC,EAAMJ,EAAOI,IACbC,GAAQ,EAAI9B,0BAAmC,SAAGyB,EAAQ,CAAC,UAAW,QAKtEG,GAAWC,GACTR,EAAOQ,MAAQA,GACjBD,EAAQV,KAAKW,EAAKtB,WAAoB,QAAEwB,UAAUD,UAM3D,CACDV,IAAK,uBACLtB,MAAO,WACLmB,KAAKK,gBAON,CACDF,IAAK,cACLtB,MAAO,WACL,OAAOmB,KAAKY,MAEb,CACDT,IAAK,SACLtB,MAAO,WACL,IAAIkC,EAASf,KAEb,OAAOX,OAAgB,QAAE2B,cAAczB,SAAS0B,gBAAgBC,SAAU,KAAM,SAAUC,GACxF,IAAIb,EAAQa,EAAKb,MACZS,EAAOT,QAAOS,EAAOT,MAAQA,GAClC,IAAIJ,EAAQa,EAAOb,MAAMA,MAAQa,EAAOb,MAAMA,MAAQa,EAAOT,MAAMG,WAC/DW,EAAW,GAEX1B,IACF0B,EAAW1B,EAAmBqB,EAAOT,MAAMc,SAASC,KAAKN,EAAOT,SAGlE,IAAIR,EAAQ,GAMZ,OAJIL,IACFK,EAAQL,EAAgBH,WAAoB,QAAEwB,UAAUZ,KAGnDb,OAAgB,QAAE2B,cAAcrB,GAAW,EAAIb,UAAmB,SAAG,CAC1EwC,IAAK,SAAaV,GAChBG,EAAOH,IAAMA,IAEdd,EAAOiB,EAAOjB,MAAOsB,UAIvBvB,EArFJ,CAsFHR,OAAgB,QAAEM,aAK1Bf,QAAiB,QAAIY","file":"createConnect.js","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _extends2 = _interopRequireDefault(require(\"@babel/runtime/helpers/extends\"));\n\nvar _objectWithoutProperties2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectWithoutProperties\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _possibleConstructorReturn2 = _interopRequireDefault(require(\"@babel/runtime/helpers/possibleConstructorReturn\"));\n\nvar _getPrototypeOf2 = _interopRequireDefault(require(\"@babel/runtime/helpers/getPrototypeOf\"));\n\nvar _inherits2 = _interopRequireDefault(require(\"@babel/runtime/helpers/inherits\"));\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _immutable = _interopRequireDefault(require(\"../util/immutable\"));\n\nvar _Context = require(\"./Context\");\n\n/**\r\n * createConnect\r\n * @param {Function} - mapStateToProps\r\n * @param {Function} - mapDispatchToProps\r\n * @return {HOC}\r\n */\nvar _default = function _default(mapStateToProps, mapDispatchToProps) {\n  /**\r\n   * ConnectHOC\r\n   * @param {ReactElement} - Component\r\n   */\n  return function (Component) {\n    return (/*#__PURE__*/function (_React$Component) {\n        (0, _inherits2[\"default\"])(_class, _React$Component);\n\n        function _class(props) {\n          var _this;\n\n          (0, _classCallCheck2[\"default\"])(this, _class);\n          _this = (0, _possibleConstructorReturn2[\"default\"])(this, (0, _getPrototypeOf2[\"default\"])(_class).call(this, props));\n          _this.state = {\n            state: null\n          };\n          return _this;\n        }\n\n        (0, _createClass2[\"default\"])(_class, [{\n          key: \"componentDidMount\",\n          value: function componentDidMount() {\n            var _this2 = this;\n\n            this.unsubscribe = this.store.subscribe(function (action) {\n              var state = _this2.store.getState();\n\n              _this2.setState({\n                state: state\n              }, function () {\n                // 如果是当前实力进行的数据更改才会调用success\n                var success = action.success,\n                    ins = action.ins,\n                    other = (0, _objectWithoutProperties2[\"default\"])(action, [\"success\", \"ins\"]); // console.log('redux进行了数据改变的通知');\n                // console.log(action);\n                // console.log(this.ins);\n                // console.log(this.ins === ins);\n\n                if (success && ins) {\n                  if (_this2.ins === ins) {\n                    success.call(ins, _immutable[\"default\"].cloneDeep(other));\n                  }\n                }\n              });\n            });\n          }\n        }, {\n          key: \"componentWillUnmount\",\n          value: function componentWillUnmount() {\n            this.unsubscribe();\n          }\n          /**\r\n           * getInstance\r\n           * @return {ReactElement}\r\n           */\n\n        }, {\n          key: \"getInstance\",\n          value: function getInstance() {\n            return this.ins;\n          }\n        }, {\n          key: \"render\",\n          value: function render() {\n            var _this3 = this;\n\n            return _react[\"default\"].createElement(_Context.ProviderContext.Consumer, null, function (_ref) {\n              var store = _ref.store;\n              if (!_this3.store) _this3.store = store;\n              var state = _this3.state.state ? _this3.state.state : _this3.store.getState();\n              var dispatch = {};\n\n              if (mapDispatchToProps) {\n                dispatch = mapDispatchToProps(_this3.store.dispatch.bind(_this3.store));\n              }\n\n              var props = {};\n\n              if (mapStateToProps) {\n                props = mapStateToProps(_immutable[\"default\"].cloneDeep(state));\n              }\n\n              return _react[\"default\"].createElement(Component, (0, _extends2[\"default\"])({\n                ref: function ref(ins) {\n                  _this3.ins = ins;\n                }\n              }, props, _this3.props, dispatch));\n            });\n          }\n        }]);\n        return _class;\n      }(_react[\"default\"].Component)\n    );\n  };\n};\n\nexports[\"default\"] = _default;"]}